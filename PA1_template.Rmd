# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
First, unzip the .csv file and read it into R.  
```{r}
unzip("activity.zip", files = "activity.csv")
data <- read.csv("activity.csv")
```

## What is mean total number of steps taken per day?
First sum the number of steps per day.
```{r}
library("reshape2")
datamelt <- melt(data, id = "date", measure.vars = "steps")
sumSteps <- dcast(datamelt, date ~ variable, sum)
```
Plot
```{r}
hist(sumSteps$steps, xlab = "Steps", main = "Total Steps Taken", col = "gray")
```
  
  
Find the mean and median
```{r}
mean(sumSteps$steps, na.rm = TRUE)
median(sumSteps$steps, na.rm = TRUE)
```


## What is the average daily activity pattern?

```{r}
datamelt2 <- melt(data, id = "interval", measure.vars = "steps", na.rm = TRUE)
avgSteps <- dcast(datamelt2, interval ~ variable, mean)
```

Make the plot
  
```{r}
library("ggplot2")
g <- ggplot(avgSteps, aes(interval, steps))
g + geom_line(colour = "blue")+
        labs(title = "Step Taken Each Interval\nAveraged Across all Days",
             x="Interval", y = "Steps")
plot(avgSteps, type = "l", 
     main = "Step Taken Each Interval\nAveraged Across all Days")
```
  
Find the interval on average across all days contains the maximum number of steps
```{r}
avgSteps[avgSteps$steps==max(avgSteps$steps),]
```


## Imputing missing values
Calculate the total number of rows with missing values.
The easiest way to do that is to use the is.na() function. Rows that are NA are  
marked as TRUE or 1, so we can sum those to get the total number of rows  
containing NAs.
  
```{r}
sum(is.na(data$steps))
```



```{r}
data$row <- as.numeric(rownames(data))
```

```{r}
imputedsteps <- NULL
for (i in data$row){
        if(is.na(data$steps[i])) {
                timeInt <- data$interval[i]
                imp <- avgSteps[avgSteps$interval==timeInt,]$steps
                imputedsteps <- c(imputedsteps, imp)
        } else {
                imputedsteps <- c(imputedsteps,data$steps[i])
        }
}

```
  
The imputed steps can replace the steps in a new data set.  
Create the new data set, then replace the steps with the imputed steps.
```{r}
data2 <- data
data2$steps <- imputedsteps
```
  
In the original data set, there were 2304 NAs in the steps variable. Count the  
NAs in the new data set to be sure they were filled in.

```{r}
sum(is.na(data2$steps))
```

  
The reshape the data to get the median and mean.
```{r}
datamelt2 <- melt(data2, id = "date", measure.vars = "steps")
sumSteps2 <- dcast(datamelt2, date ~ variable, sum)
mean(sumSteps2$steps)
median(sumSteps2$steps)
```

The change in data did not have an impact on the average, but it did bring the  
median up from 10765 to 10766

## Are there differences in activity patterns between weekdays and weekends?
Using the dataset with the imputed values, add find out whether the dates are  
weekdays are not
```{r}
library(lubridate)
data2$date <- ymd(data2$date)
wday <- as.integer(weekdays(data2$date)=="Saturday"|weekdays(data2$date)=="Sunday")
data2$weekday <- as.factor(as.character(wday))
levels(data2$weekday) <- c("weekday", "weekend")
weekdaymelt <- melt(data2, id = c("weekday", "interval"), measure.vars = "steps")
avgSteps2 <- dcast(weekdaymelt, weekday + interval ~ variable, mean)
g<-ggplot(avgSteps2, aes(interval, steps))
g+geom_line()+facet_grid(weekday~.)+
        labs(title = "Activity Pattern\nWeekend and Weekday",
             x="Interval", y = "Steps")
```


